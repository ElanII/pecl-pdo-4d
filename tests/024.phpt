--TEST--
Grosses tables
--SKIPIF--
<?php # vim:ft=php
if (!extension_loaded('pdo')) die('skip no PDO');
if (!extension_loaded('pdo_4d')) die('skip no PDO for 4D extension');

require dirname(__FILE__) . '/../../../ext/pdo/tests/pdo_test.inc';
?>
--FILE--
<?php
if (getenv('REDIR_TEST_DIR') === false) putenv('REDIR_TEST_DIR='.dirname(__FILE__) . '/../../pdo/tests/');
require_once getenv('REDIR_TEST_DIR') . 'pdo_test.inc';
$db = PDOTest::factory();

$db->exec('CREATE TABLE test (id VARCHAR(10), val VARCHAR(10), PRIMARY KEY(id))');

$data = array(
    array('10', 'Abc', 'zxy'),
    array('20', 'Def', 'wvu'),
    array('30', 'Ghi', 'tsr'),
    array('40', 'Jkl', 'qpo'),
    array('50', 'Mno', 'nml'),
    array('60', 'Pqr', 'kji'),
);

//$stmt = $db->prepare("INSERT INTO test VALUES(?, ?, ?)");
//Insertion  de trop de variable? 

// Insert using question mark placeholders
$stmt = $db->prepare("INSERT INTO test VALUES(?, ?)");
for($i =0; $i < 1000; $i++) {
    $row = array($i, "$i");
    $stmt->execute($row);

    $r = $db->query('SELECT * FROM test');
    var_dump($r->rowCount());
    unset($r);
}


$db->query('DROP TABLE test');

?>
--EXPECT--
001+ int(1)
002+ int(2)
003+ int(3)
004+ int(4)
005+ int(5)
006+ int(6)
007+ int(7)
008+ int(8)
009+ int(9)
010+ int(10)
011+ int(11)
012+ int(12)
013+ int(13)
014+ int(14)
015+ int(15)
016+ int(16)
017+ int(17)
018+ int(18)
019+ int(19)
020+ int(20)
021+ int(21)
022+ int(22)
023+ int(23)
024+ int(24)
025+ int(25)
026+ int(26)
027+ int(27)
028+ int(28)
029+ int(29)
030+ int(30)
031+ int(31)
032+ int(32)
033+ int(33)
034+ int(34)
035+ int(35)
036+ int(36)
037+ int(37)
038+ int(38)
039+ int(39)
040+ int(40)
041+ int(41)
042+ int(42)
043+ int(43)
044+ int(44)
045+ int(45)
046+ int(46)
047+ int(47)
048+ int(48)
049+ int(49)
050+ int(50)
051+ int(51)
052+ int(52)
053+ int(53)
054+ int(54)
055+ int(55)
056+ int(56)
057+ int(57)
058+ int(58)
059+ int(59)
060+ int(60)
061+ int(61)
062+ int(62)
063+ int(63)
064+ int(64)
065+ int(65)
066+ int(66)
067+ int(67)
068+ int(68)
069+ int(69)
070+ int(70)
071+ int(71)
072+ int(72)
073+ int(73)
074+ int(74)
075+ int(75)
076+ int(76)
077+ int(77)
078+ int(78)
079+ int(79)
080+ int(80)
081+ int(81)
082+ int(82)
083+ int(83)
084+ int(84)
085+ int(85)
086+ int(86)
087+ int(87)
088+ int(88)
089+ int(89)
090+ int(90)
091+ int(91)
092+ int(92)
093+ int(93)
094+ int(94)
095+ int(95)
096+ int(96)
097+ int(97)
098+ int(98)
099+ int(99)
100+ int(100)
101+ int(101)
102+ int(102)
103+ int(103)
104+ int(104)
105+ int(105)
106+ int(106)
107+ int(107)
108+ int(108)
109+ int(109)
110+ int(110)
111+ int(111)
112+ int(112)
113+ int(113)
114+ int(114)
115+ int(115)
116+ int(116)
117+ int(117)
118+ int(118)
119+ int(119)
120+ int(120)
121+ int(121)
122+ int(122)
123+ int(123)
124+ int(124)
125+ int(125)
126+ int(126)
127+ int(127)
128+ int(128)
129+ int(129)
130+ int(130)
131+ int(131)
132+ int(132)
133+ int(133)
134+ int(134)
135+ int(135)
136+ int(136)
137+ int(137)
138+ int(138)
139+ int(139)
140+ int(140)
141+ int(141)
142+ int(142)
143+ int(143)
144+ int(144)
145+ int(145)
146+ int(146)
147+ int(147)
148+ int(148)
149+ int(149)
150+ int(150)
151+ int(151)
152+ int(152)
153+ int(153)
154+ int(154)
155+ int(155)
156+ int(156)
157+ int(157)
158+ int(158)
159+ int(159)
160+ int(160)
161+ int(161)
162+ int(162)
163+ int(163)
164+ int(164)
165+ int(165)
166+ int(166)
167+ int(167)
168+ int(168)
169+ int(169)
170+ int(170)
171+ int(171)
172+ int(172)
173+ int(173)
174+ int(174)
175+ int(175)
176+ int(176)
177+ int(177)
178+ int(178)
179+ int(179)
180+ int(180)
181+ int(181)
182+ int(182)
183+ int(183)
184+ int(184)
185+ int(185)
186+ int(186)
187+ int(187)
188+ int(188)
189+ int(189)
190+ int(190)
191+ int(191)
192+ int(192)
193+ int(193)
194+ int(194)
195+ int(195)
196+ int(196)
197+ int(197)
198+ int(198)
199+ int(199)
200+ int(200)
201+ int(201)
202+ int(202)
203+ int(203)
204+ int(204)
205+ int(205)
206+ int(206)
207+ int(207)
208+ int(208)
209+ int(209)
210+ int(210)
211+ int(211)
212+ int(212)
213+ int(213)
214+ int(214)
215+ int(215)
216+ int(216)
217+ int(217)
218+ int(218)
219+ int(219)
220+ int(220)
221+ int(221)
222+ int(222)
223+ int(223)
224+ int(224)
225+ int(225)
226+ int(226)
227+ int(227)
228+ int(228)
229+ int(229)
230+ int(230)
231+ int(231)
232+ int(232)
233+ int(233)
234+ int(234)
235+ int(235)
236+ int(236)
237+ int(237)
238+ int(238)
239+ int(239)
240+ int(240)
241+ int(241)
242+ int(242)
243+ int(243)
244+ int(244)
245+ int(245)
246+ int(246)
247+ int(247)
248+ int(248)
249+ int(249)
250+ int(250)
251+ int(251)
252+ int(252)
253+ int(253)
254+ int(254)
255+ int(255)
256+ int(256)
257+ int(257)
258+ int(258)
259+ int(259)
260+ int(260)
261+ int(261)
262+ int(262)
263+ int(263)
264+ int(264)
265+ int(265)
266+ int(266)
267+ int(267)
268+ int(268)
269+ int(269)
270+ int(270)
271+ int(271)
272+ int(272)
273+ int(273)
274+ int(274)
275+ int(275)
276+ int(276)
277+ int(277)
278+ int(278)
279+ int(279)
280+ int(280)
281+ int(281)
282+ int(282)
283+ int(283)
284+ int(284)
285+ int(285)
286+ int(286)
287+ int(287)
288+ int(288)
289+ int(289)
290+ int(290)
291+ int(291)
292+ int(292)
293+ int(293)
294+ int(294)
295+ int(295)
296+ int(296)
297+ int(297)
298+ int(298)
299+ int(299)
300+ int(300)
301+ int(301)
302+ int(302)
303+ int(303)
304+ int(304)
305+ int(305)
306+ int(306)
307+ int(307)
308+ int(308)
309+ int(309)
310+ int(310)
311+ int(311)
312+ int(312)
313+ int(313)
314+ int(314)
315+ int(315)
316+ int(316)
317+ int(317)
318+ int(318)
319+ int(319)
320+ int(320)
321+ int(321)
322+ int(322)
323+ int(323)
324+ int(324)
325+ int(325)
326+ int(326)
327+ int(327)
328+ int(328)
329+ int(329)
330+ int(330)
331+ int(331)
332+ int(332)
333+ int(333)
334+ int(334)
335+ int(335)
336+ int(336)
337+ int(337)
338+ int(338)
339+ int(339)
340+ int(340)
341+ int(341)
342+ int(342)
343+ int(343)
344+ int(344)
345+ int(345)
346+ int(346)
347+ int(347)
348+ int(348)
349+ int(349)
350+ int(350)
351+ int(351)
352+ int(352)
353+ int(353)
354+ int(354)
355+ int(355)
356+ int(356)
357+ int(357)
358+ int(358)
359+ int(359)
360+ int(360)
361+ int(361)
362+ int(362)
363+ int(363)
364+ int(364)
365+ int(365)
366+ int(366)
367+ int(367)
368+ int(368)
369+ int(369)
370+ int(370)
371+ int(371)
372+ int(372)
373+ int(373)
374+ int(374)
375+ int(375)
376+ int(376)
377+ int(377)
378+ int(378)
379+ int(379)
380+ int(380)
381+ int(381)
382+ int(382)
383+ int(383)
384+ int(384)
385+ int(385)
386+ int(386)
387+ int(387)
388+ int(388)
389+ int(389)
390+ int(390)
391+ int(391)
392+ int(392)
393+ int(393)
394+ int(394)
395+ int(395)
396+ int(396)
397+ int(397)
398+ int(398)
399+ int(399)
400+ int(400)
401+ int(401)
402+ int(402)
403+ int(403)
404+ int(404)
405+ int(405)
406+ int(406)
407+ int(407)
408+ int(408)
409+ int(409)
410+ int(410)
411+ int(411)
412+ int(412)
413+ int(413)
414+ int(414)
415+ int(415)
416+ int(416)
417+ int(417)
418+ int(418)
419+ int(419)
420+ int(420)
421+ int(421)
422+ int(422)
423+ int(423)
424+ int(424)
425+ int(425)
426+ int(426)
427+ int(427)
428+ int(428)
429+ int(429)
430+ int(430)
431+ int(431)
432+ int(432)
433+ int(433)
434+ int(434)
435+ int(435)
436+ int(436)
437+ int(437)
438+ int(438)
439+ int(439)
440+ int(440)
441+ int(441)
442+ int(442)
443+ int(443)
444+ int(444)
445+ int(445)
446+ int(446)
447+ int(447)
448+ int(448)
449+ int(449)
450+ int(450)
451+ int(451)
452+ int(452)
453+ int(453)
454+ int(454)
455+ int(455)
456+ int(456)
457+ int(457)
458+ int(458)
459+ int(459)
460+ int(460)
461+ int(461)
462+ int(462)
463+ int(463)
464+ int(464)
465+ int(465)
466+ int(466)
467+ int(467)
468+ int(468)
469+ int(469)
470+ int(470)
471+ int(471)
472+ int(472)
473+ int(473)
474+ int(474)
475+ int(475)
476+ int(476)
477+ int(477)
478+ int(478)
479+ int(479)
480+ int(480)
481+ int(481)
482+ int(482)
483+ int(483)
484+ int(484)
485+ int(485)
486+ int(486)
487+ int(487)
488+ int(488)
489+ int(489)
490+ int(490)
491+ int(491)
492+ int(492)
493+ int(493)
494+ int(494)
495+ int(495)
496+ int(496)
497+ int(497)
498+ int(498)
499+ int(499)
500+ int(500)
501+ int(501)
502+ int(502)
503+ int(503)
504+ int(504)
505+ int(505)
506+ int(506)
507+ int(507)
508+ int(508)
509+ int(509)
510+ int(510)
511+ int(511)
512+ int(512)
513+ int(513)
514+ int(514)
515+ int(515)
516+ int(516)
517+ int(517)
518+ int(518)
519+ int(519)
520+ int(520)
521+ int(521)
522+ int(522)
523+ int(523)
524+ int(524)
525+ int(525)
526+ int(526)
527+ int(527)
528+ int(528)
529+ int(529)
530+ int(530)
531+ int(531)
532+ int(532)
533+ int(533)
534+ int(534)
535+ int(535)
536+ int(536)
537+ int(537)
538+ int(538)
539+ int(539)
540+ int(540)
541+ int(541)
542+ int(542)
543+ int(543)
544+ int(544)
545+ int(545)
546+ int(546)
547+ int(547)
548+ int(548)
549+ int(549)
550+ int(550)
551+ int(551)
552+ int(552)
553+ int(553)
554+ int(554)
555+ int(555)
556+ int(556)
557+ int(557)
558+ int(558)
559+ int(559)
560+ int(560)
561+ int(561)
562+ int(562)
563+ int(563)
564+ int(564)
565+ int(565)
566+ int(566)
567+ int(567)
568+ int(568)
569+ int(569)
570+ int(570)
571+ int(571)
572+ int(572)
573+ int(573)
574+ int(574)
575+ int(575)
576+ int(576)
577+ int(577)
578+ int(578)
579+ int(579)
580+ int(580)
581+ int(581)
582+ int(582)
583+ int(583)
584+ int(584)
585+ int(585)
586+ int(586)
587+ int(587)
588+ int(588)
589+ int(589)
590+ int(590)
591+ int(591)
592+ int(592)
593+ int(593)
594+ int(594)
595+ int(595)
596+ int(596)
597+ int(597)
598+ int(598)
599+ int(599)
600+ int(600)
601+ int(601)
602+ int(602)
603+ int(603)
604+ int(604)
605+ int(605)
606+ int(606)
607+ int(607)
608+ int(608)
609+ int(609)
610+ int(610)
611+ int(611)
612+ int(612)
613+ int(613)
614+ int(614)
615+ int(615)
616+ int(616)
617+ int(617)
618+ int(618)
619+ int(619)
620+ int(620)
621+ int(621)
622+ int(622)
623+ int(623)
624+ int(624)
625+ int(625)
626+ int(626)
627+ int(627)
628+ int(628)
629+ int(629)
630+ int(630)
631+ int(631)
632+ int(632)
633+ int(633)
634+ int(634)
635+ int(635)
636+ int(636)
637+ int(637)
638+ int(638)
639+ int(639)
640+ int(640)
641+ int(641)
642+ int(642)
643+ int(643)
644+ int(644)
645+ int(645)
646+ int(646)
647+ int(647)
648+ int(648)
649+ int(649)
650+ int(650)
651+ int(651)
652+ int(652)
653+ int(653)
654+ int(654)
655+ int(655)
656+ int(656)
657+ int(657)
658+ int(658)
659+ int(659)
660+ int(660)
661+ int(661)
662+ int(662)
663+ int(663)
664+ int(664)
665+ int(665)
666+ int(666)
667+ int(667)
668+ int(668)
669+ int(669)
670+ int(670)
671+ int(671)
672+ int(672)
673+ int(673)
674+ int(674)
675+ int(675)
676+ int(676)
677+ int(677)
678+ int(678)
679+ int(679)
680+ int(680)
681+ int(681)
682+ int(682)
683+ int(683)
684+ int(684)
685+ int(685)
686+ int(686)
687+ int(687)
688+ int(688)
689+ int(689)
690+ int(690)
691+ int(691)
692+ int(692)
693+ int(693)
694+ int(694)
695+ int(695)
696+ int(696)
697+ int(697)
698+ int(698)
699+ int(699)
700+ int(700)
701+ int(701)
702+ int(702)
703+ int(703)
704+ int(704)
705+ int(705)
706+ int(706)
707+ int(707)
708+ int(708)
709+ int(709)
710+ int(710)
711+ int(711)
712+ int(712)
713+ int(713)
714+ int(714)
715+ int(715)
716+ int(716)
717+ int(717)
718+ int(718)
719+ int(719)
720+ int(720)
721+ int(721)
722+ int(722)
723+ int(723)
724+ int(724)
725+ int(725)
726+ int(726)
727+ int(727)
728+ int(728)
729+ int(729)
730+ int(730)
731+ int(731)
732+ int(732)
733+ int(733)
734+ int(734)
735+ int(735)
736+ int(736)
737+ int(737)
738+ int(738)
739+ int(739)
740+ int(740)
741+ int(741)
742+ int(742)
743+ int(743)
744+ int(744)
745+ int(745)
746+ int(746)
747+ int(747)
748+ int(748)
749+ int(749)
750+ int(750)
751+ int(751)
752+ int(752)
753+ int(753)
754+ int(754)
755+ int(755)
756+ int(756)
757+ int(757)
758+ int(758)
759+ int(759)
760+ int(760)
761+ int(761)
762+ int(762)
763+ int(763)
764+ int(764)
765+ int(765)
766+ int(766)
767+ int(767)
768+ int(768)
769+ int(769)
770+ int(770)
771+ int(771)
772+ int(772)
773+ int(773)
774+ int(774)
775+ int(775)
776+ int(776)
777+ int(777)
778+ int(778)
779+ int(779)
780+ int(780)
781+ int(781)
782+ int(782)
783+ int(783)
784+ int(784)
785+ int(785)
786+ int(786)
787+ int(787)
788+ int(788)
789+ int(789)
790+ int(790)
791+ int(791)
792+ int(792)
793+ int(793)
794+ int(794)
795+ int(795)
796+ int(796)
797+ int(797)
798+ int(798)
799+ int(799)
800+ int(800)
801+ int(801)
802+ int(802)
803+ int(803)
804+ int(804)
805+ int(805)
806+ int(806)
807+ int(807)
808+ int(808)
809+ int(809)
810+ int(810)
811+ int(811)
812+ int(812)
813+ int(813)
814+ int(814)
815+ int(815)
816+ int(816)
817+ int(817)
818+ int(818)
819+ int(819)
820+ int(820)
821+ int(821)
822+ int(822)
823+ int(823)
824+ int(824)
825+ int(825)
826+ int(826)
827+ int(827)
828+ int(828)
829+ int(829)
830+ int(830)
831+ int(831)
832+ int(832)
833+ int(833)
834+ int(834)
835+ int(835)
836+ int(836)
837+ int(837)
838+ int(838)
839+ int(839)
840+ int(840)
841+ int(841)
842+ int(842)
843+ int(843)
844+ int(844)
845+ int(845)
846+ int(846)
847+ int(847)
848+ int(848)
849+ int(849)
850+ int(850)
851+ int(851)
852+ int(852)
853+ int(853)
854+ int(854)
855+ int(855)
856+ int(856)
857+ int(857)
858+ int(858)
859+ int(859)
860+ int(860)
861+ int(861)
862+ int(862)
863+ int(863)
864+ int(864)
865+ int(865)
866+ int(866)
867+ int(867)
868+ int(868)
869+ int(869)
870+ int(870)
871+ int(871)
872+ int(872)
873+ int(873)
874+ int(874)
875+ int(875)
876+ int(876)
877+ int(877)
878+ int(878)
879+ int(879)
880+ int(880)
881+ int(881)
882+ int(882)
883+ int(883)
884+ int(884)
885+ int(885)
886+ int(886)
887+ int(887)
888+ int(888)
889+ int(889)
890+ int(890)
891+ int(891)
892+ int(892)
893+ int(893)
894+ int(894)
895+ int(895)
896+ int(896)
897+ int(897)
898+ int(898)
899+ int(899)
900+ int(900)
901+ int(901)
902+ int(902)
903+ int(903)
904+ int(904)
905+ int(905)
906+ int(906)
907+ int(907)
908+ int(908)
909+ int(909)
910+ int(910)
911+ int(911)
912+ int(912)
913+ int(913)
914+ int(914)
915+ int(915)
916+ int(916)
917+ int(917)
918+ int(918)
919+ int(919)
920+ int(920)
921+ int(921)
922+ int(922)
923+ int(923)
924+ int(924)
925+ int(925)
926+ int(926)
927+ int(927)
928+ int(928)
929+ int(929)
930+ int(930)
931+ int(931)
932+ int(932)
933+ int(933)
934+ int(934)
935+ int(935)
936+ int(936)
937+ int(937)
938+ int(938)
939+ int(939)
940+ int(940)
941+ int(941)
942+ int(942)
943+ int(943)
944+ int(944)
945+ int(945)
946+ int(946)
947+ int(947)
948+ int(948)
949+ int(949)
950+ int(950)
951+ int(951)
952+ int(952)
953+ int(953)
954+ int(954)
955+ int(955)
956+ int(956)
957+ int(957)
958+ int(958)
959+ int(959)
960+ int(960)
961+ int(961)
962+ int(962)
963+ int(963)
964+ int(964)
965+ int(965)
966+ int(966)
967+ int(967)
968+ int(968)
969+ int(969)
970+ int(970)
971+ int(971)
972+ int(972)
973+ int(973)
974+ int(974)
975+ int(975)
976+ int(976)
977+ int(977)
978+ int(978)
979+ int(979)
980+ int(980)
981+ int(981)
982+ int(982)
983+ int(983)
984+ int(984)
985+ int(985)
986+ int(986)
987+ int(987)
988+ int(988)
989+ int(989)
990+ int(990)
991+ int(991)
992+ int(992)
993+ int(993)
994+ int(994)
995+ int(995)
996+ int(996)
997+ int(997)
998+ int(998)
999+ int(999)
1000+ int(1000)
